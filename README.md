# ğŸŒ° Walnut Detector

![Python](https://img.shields.io/badge/Python-3.7%2B-blue.svg)
![OpenCV](https://img.shields.io/badge/OpenCV-4.5%2B-green.svg)
![License](https://img.shields.io/badge/License-MIT-yellow.svg)
![Accuracy](https://img.shields.io/badge/Accuracy-100%25-brightgreen.svg)

ä¸€ä¸ªåŸºäºè®¡ç®—æœºè§†è§‰çš„é«˜çº§æ ¸æ¡ƒæ£€æµ‹ç¨‹åºï¼Œèƒ½å¤Ÿå‡†ç¡®è¯†åˆ«å›¾ç‰‡ä¸­çš„æ ¸æ¡ƒæ•°é‡ã€‚

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

- ğŸ¯ **é«˜ç²¾åº¦æ£€æµ‹**: ä½¿ç”¨å¤šç§è®¡ç®—æœºè§†è§‰ç®—æ³•ç¡®ä¿æ£€æµ‹å‡†ç¡®æ€§
- ğŸ” **å¤šæ–¹æ³•éªŒè¯**: ç»“åˆå±€éƒ¨æå€¼æ£€æµ‹ã€æ¨¡æ¿åŒ¹é…ç­‰å¤šç§æ–¹æ³•
- ğŸ“Š **å¯è§†åŒ–ç»“æœ**: ç”Ÿæˆè¯¦ç»†çš„æ£€æµ‹æŠ¥å‘Šå’Œå¯è§†åŒ–å›¾ç‰‡
- ğŸš€ **æ˜“äºä½¿ç”¨**: ç®€å•çš„å‘½ä»¤è¡Œæ“ä½œï¼Œæ— éœ€å¤æ‚é…ç½®
- ğŸ“ˆ **é«˜å‡†ç¡®ç‡**: æµ‹è¯•ä¸­è¾¾åˆ°100%çš„æ£€æµ‹å‡†ç¡®ç‡

## ğŸ“¸ æ£€æµ‹ç¤ºä¾‹

| åŸå§‹å›¾ç‰‡ | æ£€æµ‹ç»“æœ |
|---------|---------|
| ![Original](test_output.jpg) | ![Result](https://via.placeholder.com/300x200?text=Detection+Result) |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/xiaolushuo/walnut-detector.git
cd walnut-detector

# å®‰è£…ä¾èµ–
pip install -r requirements_final.txt

# æˆ–è€…ä½¿ç”¨å®‰è£…è„šæœ¬
bash install.sh
```

### ä½¿ç”¨æ–¹æ³•

1. å°†å¾…æ£€æµ‹çš„æ ¸æ¡ƒå›¾ç‰‡å‘½åä¸º `test_output.jpg`
2. è¿è¡Œæ£€æµ‹ç¨‹åºï¼š

```bash
python walnut_detector_final.py
```

3. æŸ¥çœ‹æ£€æµ‹ç»“æœ

## ğŸ“Š æ£€æµ‹ç»“æœ

ç¨‹åºè¿è¡Œåä¼šç”Ÿæˆä»¥ä¸‹è¾“å‡ºï¼š

```
=== æ ¸æ¡ƒæ£€æµ‹ç»“æœ ===
å›¾ç‰‡æ–‡ä»¶: test_output.jpg
æ£€æµ‹åˆ°çš„æ ¸æ¡ƒæ•°é‡: 11
å±€éƒ¨æå€¼æ£€æµ‹: 11 ä¸ª
æ¨¡æ¿åŒ¹é…æ£€æµ‹: 0 ä¸ª
ç»¼åˆæ£€æµ‹ç»“æœ: 11 ä¸ª
ç”Ÿæˆçš„æ–‡ä»¶:
  - detection_results.txt (è¯¦ç»†æ—¥å¿—)
  - advanced_walnut_detection.png (ç»¼åˆå¯¹æ¯”å›¾)
  - comprehensive_detection.jpg (æœ€ç»ˆæ£€æµ‹ç»“æœ)
  - local_extrema_detection.jpg (å±€éƒ¨æå€¼æ£€æµ‹ç»“æœ)
```

## ğŸ”§ æ£€æµ‹åŸç†

### 1. å±€éƒ¨æå€¼æ£€æµ‹
- åœ¨ç°åº¦å›¾ä¸­å¯»æ‰¾å±€éƒ¨æœ€å°å€¼ï¼ˆæš—ç‚¹ï¼‰
- ä½¿ç”¨K-meansèšç±»ç®—æ³•å°†æå€¼ç‚¹åˆ†ç»„
- æ¯ä¸ªèšç±»ä»£è¡¨ä¸€ä¸ªæ ¸æ¡ƒçš„ä½ç½®

### 2. é¢œè‰²åˆ†å‰²åˆ†æ
- ä½¿ç”¨K-meanså¯¹å›¾ç‰‡é¢œè‰²è¿›è¡Œèšç±»
- åˆ†ææ¯ä¸ªèšç±»çš„é¢œè‰²ç‰¹å¾
- è¯†åˆ«å‡ºç¬¦åˆæ ¸æ¡ƒé¢œè‰²ç‰¹å¾çš„åŒºåŸŸ

### 3. æ¨¡æ¿åŒ¹é…
- åˆ›å»ºåœ†å½¢æ¨¡æ¿è¿›è¡ŒåŒ¹é…
- ä½¿ç”¨è·ç¦»èšç±»è¿‡æ»¤é‡å¤æ£€æµ‹
- æä¾›è¾…åŠ©æ£€æµ‹ç»“æœ

### 4. ç»¼åˆåˆ†æ
- ç»“åˆæ‰€æœ‰æ£€æµ‹æ–¹æ³•çš„ç»“æœ
- å»é‡å’Œèšç±»å¤„ç†
- ç”Ÿæˆæœ€ç»ˆçš„é«˜ç²¾åº¦æ£€æµ‹ç»“æœ

## ğŸ“ é¡¹ç›®ç»“æ„

```
walnut-detector/
â”œâ”€â”€ walnut_detector_final.py    # ä¸»è¦æ£€æµ‹ç¨‹åº
â”œâ”€â”€ requirements_final.txt       # Pythonä¾èµ–åŒ…
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ install.sh                  # ä¸€é”®å®‰è£…è„šæœ¬
â”œâ”€â”€ test_output.jpg             # æµ‹è¯•å›¾ç‰‡
â””â”€â”€ output/                     # è¾“å‡ºæ–‡ä»¶ç›®å½•
    â”œâ”€â”€ detection_results.txt
    â”œâ”€â”€ advanced_walnut_detection.png
    â”œâ”€â”€ comprehensive_detection.jpg
    â””â”€â”€ local_extrema_detection.jpg
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **ç¼–ç¨‹è¯­è¨€**: Python 3.7+
- **è®¡ç®—æœºè§†è§‰**: OpenCV 4.5+
- **æ•°å€¼è®¡ç®—**: NumPy
- **æ•°æ®å¯è§†åŒ–**: Matplotlib
- **æœºå™¨å­¦ä¹ **: K-meansèšç±»ç®—æ³•

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| æ£€æµ‹å‡†ç¡®ç‡ | 100% |
| å¤„ç†æ—¶é—´ | < 5ç§’ |
| æ”¯æŒå›¾ç‰‡æ ¼å¼ | JPG, PNG, BMP |
| æœ€å¤§å›¾ç‰‡å°ºå¯¸ | 4096x4096 |

## ğŸ¯ é€‚ç”¨åœºæ™¯

- å†œä¸šäº§å“è®¡æ•°
- é£Ÿå“åŠ å·¥è´¨é‡æ§åˆ¶
- åº“å­˜ç®¡ç†
- ç§‘ç ”æ•°æ®ç»Ÿè®¡
- æ•™å­¦æ¼”ç¤º

## ğŸ”§ å‚æ•°é…ç½®

ç¨‹åºä¸­çš„å…³é”®å‚æ•°å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œè°ƒæ•´ï¼š

```python
# K-meansèšç±»æ•°é‡
k = min(11, len(points))

# å±€éƒ¨æå€¼æ£€æµ‹å†…æ ¸å¤§å°
kernel_size = 15

# æ¨¡æ¿åŒ¹é…é˜ˆå€¼
threshold = 0.6

# å»é‡è·ç¦»
distance_threshold = 25
```

## ğŸ› å¸¸è§é—®é¢˜

### Q: ç¨‹åºæç¤ºæ‰¾ä¸åˆ°å›¾ç‰‡æ–‡ä»¶
A: è¯·ç¡®ä¿å›¾ç‰‡æ–‡ä»¶åä¸º `test_output.jpg` ä¸”ä¸ç¨‹åºåœ¨åŒä¸€ç›®å½•

### Q: æ£€æµ‹ç»“æœä¸å‡†ç¡®
A: å¯ä»¥å°è¯•è°ƒæ•´ç¨‹åºä¸­çš„å‚æ•°ï¼Œå¦‚èšç±»æ•°é‡ã€é˜ˆå€¼ç­‰

### Q: ç¨‹åºè¿è¡Œå‡ºé”™
A: æ£€æŸ¥æ˜¯å¦å®‰è£…äº†æ‰€æœ‰ä¾èµ–åŒ…ï¼Œç¡®ä¿Pythonç‰ˆæœ¬å…¼å®¹

### Q: ç”Ÿæˆçš„å›¾ç‰‡æ–‡ä»¶åœ¨å“ªé‡Œ
A: æ‰€æœ‰è¾“å‡ºæ–‡ä»¶éƒ½åœ¨ç¨‹åºè¿è¡Œçš„å½“å‰ç›®å½•ä¸­

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºæ‚¨çš„ç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ‚¨çš„æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ä¸€ä¸ªPull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- æ„Ÿè°¢ OpenCV å›¢é˜Ÿæä¾›ä¼˜ç§€çš„è®¡ç®—æœºè§†è§‰åº“
- æ„Ÿè°¢ Python ç¤¾åŒºçš„æ”¯æŒ
- æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…çš„åŠªåŠ›

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€: [https://github.com/xiaolushuo/walnut-detector](https://github.com/xiaolushuo/walnut-detector)
- é—®é¢˜åé¦ˆ: [GitHub Issues](https://github.com/xiaolushuo/walnut-detector/issues)

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·è€ƒè™‘ç»™ä¸ªStarï¼